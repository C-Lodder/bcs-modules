(()=>{const e=Joomla.getOptions("servers"),n=n=>{const t={},o=n.querySelectorAll(".uk-icon-spin");o.forEach(e=>{e.classList.remove("uk-hidden")}),fetch("index.php?option=com_ajax&module=servers&method=getServerData&format=json").then(e=>e.json()).then(o=>{const r=o.data;Object.keys(r).forEach(o=>{const i=r[o],a=n.querySelector(`#count_${i.id}`),s=n.querySelector(`#currentmap_${i.id}`),c=n.querySelector(`#nextmap_${i.id}`);a&&(void 0!==t.login&&i.playercount>a.innerText&&(n=>{if("Notification"in window&&"granted"===Notification.permission){const t={body:`New player joined ${n}`,icon:e.img};new Notification("New Player!",t)}})(i.raw),t.login=i.playercount,a.innerHTML=i.playercount),s&&(s.innerHTML=i.currentmap),c&&(c.innerHTML=i.nextmap)})}).then(()=>{o.forEach(e=>{e.classList.add("uk-hidden")})})};window.addEventListener("DOMContentLoaded",()=>{jQuery(".players_modal").on({"show.uk.modal":function(){(n=>{const t=document.getElementById(n).querySelector(".player_list"),o={servers:n};fetch("index.php?option=com_ajax&module=servers&method=getPlayersNames&format=json",{method:"POST",body:JSON.stringify(o)}).then(e=>e.json()).then(n=>{const o=n.data;o.length?(t.innerHTML="",Object.keys(o).forEach(n=>{const r=o[n],i=1==e.isAdmin?` <span class="uk-text-muted uk-text-small">(${r.login})</span>`:"",a=`<li>${r.nickname}${i}</li>`;t.insertAdjacentHTML("beforeend",a)})):t.innerHTML='<li class="uk-text-danger">No players online</li>'})})(jQuery(this).attr("id"))}}),e.guest||window.setInterval(()=>{n(document.getElementById("tm_server"))},e.refresh)})})()