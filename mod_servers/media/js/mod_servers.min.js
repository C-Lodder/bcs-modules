(()=>{const e=Joomla.getOptions("servers"),n=n=>{const t={},o=n.querySelectorAll(".uk-icon-spin");o.forEach(e=>{e.classList.remove("uk-hidden")}),fetch("index.php?option=com_ajax&module=servers&method=getServerData&format=json").then(e=>e.json()).then(o=>{const r=o.data;Object.keys(r).forEach(o=>{const i=r[o],s=n.querySelector(`#count_${i.id}`),a=n.querySelector(`#currentmap_${i.id}`),c=n.querySelector(`#nextmap_${i.id}`);s&&(void 0!==t.login&&i.playercount>s.innerText&&(n=>{if("Notification"in window&&"granted"===Notification.permission){const t={body:`New player joined ${n}`,icon:e.img};new Notification("New Player!",t)}})(i.raw),t.login=i.playercount,s.innerHTML=i.playercount),a&&(a.innerHTML=i.currentmap),c&&(c.innerHTML=i.nextmap)})}).then(()=>{o.forEach(e=>{e.classList.add("uk-hidden")})})};window.addEventListener("DOMContentLoaded",()=>{jQuery(".players_modal").on({"show.uk.modal":function(){(n=>{const t={servers:n};fetch("index.php?option=com_ajax&module=servers&method=getPlayersNames&format=json",{method:"POST",body:JSON.stringify(t)}).then(e=>e.json()).then(n=>{const t=n.data;t.length?Object.keys(t).forEach(n=>{const o=t[n],r=1==e.isAdmin?` <span class="uk-text-muted uk-text-small">(${o.login})</span>`:"",i=`<li>${o.nickname}${r}</li>`;playerList.insertAdjacentHTML("beforeend",i)}):playerList.innerHTML='<li class="uk-text-danger">No players online</li>'})})(jQuery(this).attr("id"))}}),e.guest||window.setInterval(()=>{n(document.getElementById("tm_server"))},e.refresh)})})();