(()=>{let e,t;const a="track",n=Joomla.getOptions("bcs-tracks"),s=document.getElementById("bcstracks-slider"),r=document.querySelectorAll("#bcstracks [data-slide-move]"),o=e=>parseInt(e.offsetLeft+20,10)<=s.offsetWidth;fetch("index.php?option=com_ajax&module=tracks&method=getAuthorTracks&format=json",{method:"POST",body:JSON.stringify({authors:n.authors.split(",")})}).then((e=>e.json())).then((t=>{const n=t.data,r=Object.keys(n);e=r.length,r.forEach(((e,t)=>{const r=n[e],o=document.createElement("div");o.id=a+(t+1);const l="tm2020"===r.Game?"Trackmania":"TMStadium",c=`<a href="${r.endpoint}/maps/${r.TrackID}" target="_blank" rel="noopener">\n        <img class="screenshot" src="${r.screenshot}" alt="Thumbnail" loading="lazy">\n        <span class="flex align-items-center flex-wrap">\n          <img class="mx-logo" src="media/mod_tracks/img/${l}.webp" alt="MX Logo" loading="lazy">\n          ${r.GbxMapName}\n        </span>\n      </a>\n      <div class="by">by ${r.Username}</div>\n      <div class="by">Uploaded ${r.UploadedAt}</div>\n      <div class="flex flex-wrap justify-content-between">\n        <a class="btn btn-sm" href="${r.endpoint}/maps/download/${r.TrackID}" target="_blank" rel="noopener">Download</a>\n        <a class="btn btn-sm" href="${r.endpoint}/maps/installandplay/${r.TrackID}" target="_blank" rel="noopener">Install & Play</a>\n      </div>`;o.innerHTML=c,s.insertBefore(o,s.firstChild)}))})).then((()=>{const e=s.getElementsByClassName("placeholder");for(;e.length>0;)e[0].parentNode.removeChild(e[0])})).then((()=>{t=1,o(s.children[1])&&(t=2),o(s.children[3])&&(t=4),r.forEach((n=>{n.classList.remove("hidden");const s="next"===n.getAttribute("data-slide-move");n.href=s?`#${a+parseInt(e-t,10)}`:`#${a+parseInt(e,10)}`,n.addEventListener("click",(({currentTarget:n})=>{(n=>{r.forEach((s=>{const r=parseInt(s.getAttribute("href").replace(/\#track/,""),10),o=n?parseInt(r-1,10):parseInt(r+1,10),l="next"===s.getAttribute("data-slide-move");let c=!0;(l&&o<1||!l&&o<t+1)&&(c=!1),(!l&&o>e||l&&o>e-t)&&(c=!1),c&&s.setAttribute("href",`#${a+o}`)}))})("next"===n.getAttribute("data-slide-move"))}))}))}))})();